<?xml version="1.0" encoding="utf-8" ?>
<odoo>
  <template id="question" inherit_id="survey.question_container">
    <xpath expr="//t[@t-call='survey.question_text_box']/.." position="after">
      <t t-if="question.question_type == 'nps_rate'">
        <t t-call="survey_question_type_nps.nps_rate" />
      </t>
    </xpath>
  </template>
  <template id="result" inherit_id="survey.survey_page_statistics_question">
    <xpath expr="//div[hasclass('o_survey_question_description')]" position="after">
      <t t-if="question.question_type == 'nps_rate'">
        <t t-call="survey.question_result_number_or_date_or_datetime" />
      </t>
    </xpath>
  </template>
  <template
        id="result_user"
        inherit_id="survey.question_result_number_or_date_or_datetime"
    >
    <!-- <xpath expr="//a[@t-field='input_line.value_date']" position="after">
      <a
        t-if="question.question_type == 'nps_rate'"
        t-att-href="input_line.user_input_id.get_print_url()"
        t-field="input_line.value_numerical_box"
      />
    </xpath> -->
    <xpath expr="//tbody/tr/td" position="inside">
      <t t-if="question.question_type == 'nps_rate'">
        <span t-esc="common_line[0]" />
      </t>
    </xpath>
  </template>
  <template id="survey_page_print" inherit_id="survey.survey_page_print">
    <xpath expr="//t[@t-call='survey.question_matrix']/.." position="after">
      <t t-if="question.question_type == 'nps_rate'">
        <t t-call="survey_question_type_nps.nps_rate" />
      </t>
    </xpath>
  </template>
  <template id="nps_rate" name="NPS Rating">
    <div class="row">
      <div class="nps_rate nps_rate_widget">
        <label
                    for="num10"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 10 else ''}"
                >
          10
        </label>
        <label
                    for="num9"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 9 else ''}"
                >
          9
        </label>
        <label
                    for="num8"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 8 else ''}"
                >
          8
        </label>
        <label
                    for="num7"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 7 else ''}"
                >
          7
        </label>
        <label
                    for="num6"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 6 else ''}"
                >
          6
        </label>
        <label
                    for="num5"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 5 else ''}"
                >
          5
        </label>
        <label
                    for="num4"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 4 else ''}"
                >
          4
        </label>
        <label
                    for="num3"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 3 else ''}"
                >
          3
        </label>
        <label
                    for="num2"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 2 else ''}"
                >
          2
        </label>
        <label
                    for="num1"
                    t-attf-class="#{'checked' if answer_lines and answer_lines.value_numerical_box == 1 else ''}"
                >
          1
        </label>
        <input
                    type="number"
                    step="any"
                    class="form-control"
                    t-att-data-question-type="question.question_type"
                    t-att-name="question.id"
                    hidden="hidden"
                    t-att-value="answer_lines[0].value_numerical_box if answer_lines else None"
                />
      </div>
    </div>
  </template>

  <template id="avg_nps" inherit_id="survey.survey_page_statistics_question">
    <xpath expr="//div[hasclass('o_survey_results_question')]" position="inside">
      <t t-if="'average_nps' in question_data">
        <span class="badge badge-info ml-1">
          <span t-esc="question_data['average_nps']" />
          NPS Average
        </span>
      </t>
    </xpath>
  </template>
</odoo>
